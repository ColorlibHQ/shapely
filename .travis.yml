sudo: false
language: php
matrix:
  fast_finish: true
  include:
  - php: '5.3'
  - php: '5.4'
  - php: '5.5'
  - php: '5.6'
  - php: '7.0'
  - php: '7.1'
before_script:
- export PHPCS_DIR=/tmp/phpcs
- export SNIFFS_DIR=/tmp/sniffs
- git clone -b 2.9 --depth 1 https://github.com/squizlabs/PHP_CodeSniffer.git $PHPCS_DIR
- git clone -b master --depth 1 https://github.com/WordPress-Coding-Standards/WordPress-Coding-Standards.git
  $SNIFFS_DIR
- git clone -b master --depth 1 https://github.com/wimg/PHPCompatibility.git $SNIFFS_DIR/PHPCompatibility
- "$PHPCS_DIR/scripts/phpcs --config-set installed_paths $SNIFFS_DIR"
- phpenv rehash
- npm install -g jscs
- npm install -g jshint
- wget https://develop.svn.wordpress.org/trunk/.jshintrc
- npm install -g grunt-cli
- npm install
- npm install -g grunt-checktextdomain
script:
- mkdir -p build/logs
- find -L . -name '*.php' -print0 | xargs -0 -n 1 -P 4 php -l
- jshint ./assets/js/*.js
- jshint ./inc/admin/welcome-screen/js/*.js
- jscs ./assets/js/*.js
- jscs ./inc/admin/welcome-screen/js/*.js
- grunt textdomain
- "$PHPCS_DIR/scripts/phpcs -p -s -v -n ./*.php --standard=./phpcs.ruleset.xml --extensions=php"
- "$PHPCS_DIR/scripts/phpcs -p -s -v -n ./**/*.php --standard=./phpcs.ruleset.xml
  --extensions=php"
- "$PHPCS_DIR/scripts/phpcs -p -s -v -n ./**/**/*.php --standard=./phpcs.ruleset.xml
  --extensions=php"
- "$PHPCS_DIR/scripts/phpcs -p -s -v -n ./**/**/**/*.php --standard=./phpcs.ruleset.xml
  --extensions=php"
- "$PHPCS_DIR/scripts/phpcs -p -s -v -n ./**/**/**/**/*.php --standard=./phpcs.ruleset.xml
  --extensions=php"
notifications:
  email: false
cache:
  directories:
  - node_modules
#after_success:
#- grunt build-archive
#- sh set_tags.sh
#deploy:
#  provider: releases
#  skip_cleanup: true
#  api_key:
#    secure: FbV7d4hcOzhBRs1M/iVlseSqeaeHtLhp+Et6iP7kRVEM5rVl9zmFUppfCweQfBm9Gd4SPJkiRPAtYwKIDZwS3AO9U4jkdYOJCAysVa/zEj+t8DSFsA7EwIstu4CbQVEAADCEAmI/Yth8qbe4jF5Xg29/ykF9WCHXUhYnewSDX/Vr+AbjiitmDqojK9Ea9c0iMlVrOZEgnhfGFxLU4dsh4F/Il2pQiermoAz7r4+apvJG5IDIXFRFgY6L1tIEAnFhDgaLHuTN1QtCgoyeFxHLzSBXEjnPatefjRd4VwCLIyG3NnTSdudI9ddAg+r42ghGtslRrIlZHerc9BWFX0zXkLxVCvem126ol+/x9Uvx6TdAfGb2L3tmkquv1QgeOy0ju7mlwdwO2LepcnMwETpkPF9r4iBpT+S0GF5MbUNO6LQdqQ7Lwk4AKpdWZUO0LHdLGw5JhS99GMZZxICnsHRxBBx0DcCMTAFJsUs6RNND/ugulTUHnTtEF97XkB+2Db4CYQLsDq/hg0pnscywh+VwR3w7P91rKCsw400SsfV7FqOoLlgoexOqHVkTm0DSkNi4HN+/n4xpgByoZeIq1UzWqjyHgUACBIkuNDkP9QwSuxzWACHfYPKbl/iw7FlX9ct5mBKf4Eyeb88WufEyU/wTFHrrCXDv2EoYspPEPNvYBvk=
#  file: shapely.zip
#  on:
#    branch: master
#    repo: giucu91/shapely